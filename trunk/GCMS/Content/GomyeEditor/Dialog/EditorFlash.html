<html>
	<head>
		<title>插入 Flash 文件</title>
		<meta content="MSHTML 6.00.2800.1170" name="GENERATOR">
		<meta content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema">
		<meta http-equiv="Expires" content="0">
		<meta http-equiv="Cache-Control" content="no-cache">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="content-type" content="text/html; charset=gb2312">
		<style media="all" type="text/css">
			body {background-color: buttonface;}
			td, span, legend {font: icon;}
			fieldset {border: 1px solid #A1C3ED;}
			legend {font-weight: bold;}
			#loader, #message {color: red;}
			.flatTextBox {border: 1px solid #2E74CF;}
			.headerText {cursor:default;overflow: hidden;color: #FFFFFF;font-weight: bold;filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=1, OffY=1, Color='#000000', Positive='true');}
			button, button.disabled {background-color: transparent;border: none;width: 87px;height: 22px;}
			button {background-image: url(../Image/buttonTemplate.gif);}
			button.disabled {background-image: url(../Image/buttonTemplateDisabled.gif);}
			button table tr td, button.disabled table tr td {font-weight: bold;text-align: center;vertical-align: middle;padding-bottom: 2px;}
			button table tr td {color: #FFFFFF;filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=1, OffY=1, Color='#000000', Positive='true');}
			button.disabled table tr td {filter: ;}
		</style>
		<script language="JavaScript" src="dialog.js"></script>
		<script language="JavaScript">
		<!--
		function checkURL()
		{
			window.setTimeout("checkControl((checkImgStr(document.all['url'].value) != ''))", 100);
		}
		function checkControl(enable)
		{
			document.all['insertButton'].className = enable ? "" : "disabled";document.all['insertButton'].disabled = !enable;
		}
		function checkImgStr(str)
		{
			var re1 = /^\s{1,}/i;var re2 = /\s{1,}$/i;return str.replace(re1, "").replace(re2, "");
		}

		function insertFlash()
		{
			var returnStr = null;
			
			if ((checkImgStr(document.all.flashWidth.value) == "") ||(checkImgStr(document.all.flashHeight.value) == ""))
			{
				alert("请填写Flash文件的宽度和高度!");
			}
			else if ((document.all.classYes.checked) && (checkImgStr(document.all.classID.value) == ""))
			{
				alert("请为Flash文件指定一个 ClassID!");
			}
			else
			{
				var movieSrc = "";
				if (document.all["url"] != null)
				{movieSrc = dialogArguments.ConvertURL(document.all["url"].value);}

				if (document.all.classYes.checked)
				{
					returnStr ="<object classid=\"" + document.all.classID.value + "\" " +"codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=" + document.all.version.value + ",0,0,0\" " +"width=\"" + document.all.flashWidth.value + "\" height=\"" + document.all.flashHeight.value + "\" align=\"" + document.all.htmlAlign.value + "\">" +dHoYzI369150("movie", movieSrc, true) +dHoYzI369150("loop", document.all.loopYes.checked.toString(), true) +dHoYzI369150("menu", document.all.menuYes.checked.toString(), true) +dHoYzI369150("quality", document.all.quality.value, true) +dHoYzI369150("salign", document.all.flashAlign.value, true) +dHoYzI369150("bgcolor", document.all.backgroundColor.value, true) +dHoYzI369151(true, movieSrc) +"</object>";
				}
				else
				{
					returnStr = dHoYzI369151(true, movieSrc);
				}
				dialogArguments.insertHTML(returnStr)
				self.close();
			}
		}
		function dHoYzI369150(name, value, asText) {var text = "<param name=\"" + name + "\" value=\"" + value + "\">";if (asText) {return text;} else {return document.createElement(text);}}
		function dHoYzI369151(asText, movieSrc) {var text ="<embed src=\"" + movieSrc + "\" loop=\"" + document.all.loopYes.checked.toString() + "\" " +"menu=\"" + document.all.menuYes.checked.toString() + "\" quality=\"" + document.all.quality.value + "\" " +"salign=\"" + document.all.flashAlign.value + "\" align=\"" + document.all.htmlAlign.value + "\" " +"bgcolor=\"" + document.all.backgroundColor.value + "\" width=\"" + document.all.flashWidth.value + "\" height=\"" + document.all.flashHeight.value + "\" " +"type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\">" +"</embed>";if (asText) {return text;} else {return document.createElement(text);}}
		function dHoYzI369157(enable) {if (enable) {document.all.classID.disabled = false;document.all.version.disabled = false;self.dialogHeight = "520px";dHoYzI369143("classIDRow");} else {document.all.classID.value = "";document.all.classID.disabled = true;document.all.version.disabled = true;self.dialogHeight = "460px";dHoYzI369142("classIDRow");}}
		function dHoYzI369140(id) {try {document.all[id].style.display = "none";} catch (e) {}}
		function dHoYzI369141(id) {try {document.all[id].style.display = "block";} catch (e) {}}
		function dHoYzI369142(id) {for (var i=1; ; i++) {if (document.all[id + i] == null) { break; }else { dHoYzI369140(id + i); }}}
		function dHoYzI369143(id) {for (var i=1; ; i++) {if (document.all[id + i] == null) { break; }else { dHoYzI369141(id + i); }}}

		function openFileDialog()
		{
//			var result = OpenModalDialog(config.Parame + "=Admin^SelectDialog", null, 580, 500)
//			if ((result) && (result != ""))
//			{
//				document.all.url.value = result;
//				checkURL();
//			}
			var argu = "dialogWidth:320px; dialogHeight:130px;center:yes;status:no;help:no";
			var newimage=window.showModalDialog("../../WindowFrame.aspx?loadfile=Tools_UploadFiles.aspx",null,argu);
			if (newimage!=null) {
				document.all.url.value = newimage;
				}
		}
		
		function OpenModalDialog(url, object, width, height)
		{
			var cursor = document.body.style.cursor;
			document.body.style.cursor = "wait";
			var result = window.showModalDialog(url, object, "status:no; center:yes; help:no; minimize:no; maximize:no; scroll:no; border:thin; statusbar:no; dialogWidth:" + width + "px; dialogHeight:" + height + "px");
			document.body.style.cursor = cursor;
			return result;
		}

		function IsDigit()
		{
			return ((event.keyCode >= 48) && (event.keyCode <= 57));
		}
		//-->
		</script>
	</head>
	<body id="mainBody">
		<form name="mainForm" method="post" action="" id="mainForm">
			<table id="mainTable" width="100%" cellpadding="0" cellspacing="0">
				<tr>
					<td>
						<table width="100%" height="100%" cellpadding="6" cellspacing="0" border="0">
							<tr>
								<td valign="top"><table id="propertiesTable1" width="100%" cellpadding="3" cellspacing="0">
										<tr>
											<td id="loader" colspan="2" align="left" valign="top" style="display:none"></td>
										</tr>
										<tr>
											<td width="100">Flash 文件:</td>
											<td><input type="text" id="url" name="url" onkeydown="checkURL()" onchange="checkURL()" style="width:200px"
													class="flatTextBox"></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">指定 ClassID:</td>
											<td><input type="radio" id="classYes" name="flashClass" value="yes" onclick="dHoYzI369157(true)">
												是&nbsp;<input type="radio" id="classNo" name="flashClass" value="no" onclick="dHoYzI369157(false)"
													checked> 否</td>
										</tr>
										<tr id="classIDRow1" style="display:none">
											<td height="5"></td>
										</tr>
										<tr id="classIDRow2" style="display:none">
											<td width="100">ClassID:</td>
											<td><input type="text" id="classID" style="width:170px" class="flatTextBox" value="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"></td>
										</tr>
										<tr id="classIDRow3" style="display:none">
											<td height="5"></td>
										</tr>
										<tr id="classIDRow4" style="display:none">
											<td width="100">Flash 版本:</td>
											<td><select id="version" style="width:110px" disabled>
													<option value="5">5.0</option>
													<option value="6">6.0</option>
													<option value="7">7.0</option>
												</select></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">宽度:</td>
											<td><input type="text" id="flashWidth" style="width:110px" class="flatTextBox" ONKEYPRESS="event.returnValue=IsDigit();"></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">高度:</td>
											<td><input type="text" id="flashHeight" style="width:110px" class="flatTextBox" ONKEYPRESS="event.returnValue=IsDigit();"></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">品质:</td>
											<td><select id="quality" style="width:110px"><option value="high">高</option>
													<option value="medium">中</option>
													<option value="low">低</option>
												</select></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">循环:</td>
											<td><input type="radio" id="loopYes" name="loop" value="true"> 是&nbsp;<input type="radio" id="loopNo" name="loop" value="false" checked>
												否</td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">是否显示菜单:</td>
											<td><input type="radio" id="menuYes" name="menu" value="true"> 是&nbsp;<input type="radio" id="menuNo" name="menu" value="false" checked>
												否</td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">HTML 位置:</td>
											<td><select id="htmlAlign" style="width:110px"><option value="baseline">Baseline</option>
													<option value="bottom">Bottom</option>
													<option value="left">Left</option>
													<option value="middle">Middle</option>
													<option value="right">Right</option>
													<option value="texttop">TextTop</option>
													<option value="top">Top</option>
												</select></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">Flash 位置:</td>
											<td><select id="flashAlign" style="width:110px"><option value="LT">Left Top</option>
													<option value="LC">Left Center</option>
													<option value="LB">Left Bottom</option>
													<option value="RT">Right Top</option>
													<option value="RC">Right Center</option>
													<option value="RB">Right Bottom</option>
													<option value="CT">Center Top</option>
													<option value="CC">Center Center</option>
													<option value="CB">Center Bottom</option>
												</select></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td width="100">背景色:</td>
											<td><select id="backgroundColor" style="width:140px" onchange="dHoYzI369158(this)"><option value="">No 
														Color</option>
													<option value="#000000" style="background-color:#000000">Black</option>
													<option value="#0000FF" style="background-color:#0000FF">Blue</option>
													<option value="#008000" style="background-color:#008000">Green</option>
													<option value="#FFA500" style="background-color:#FFA500">Orange</option>
													<option value="#FF0000" style="background-color:#FF0000">Red</option>
													<option value="#FFFFFF" style="background-color:#FFFFFF">White</option>
													<option value="#FFFF00" style="background-color:#FFFF00">Yellow</option>
													<option value="_______">Custom</option>
												</select></td>
										</tr>
										<tr>
											<td height="5"></td>
										</tr>
										<tr>
											<td colspan="2"></td>
										</tr>
									</table>
								</td>
								<td width="90" valign="top">
									<table cellpadding="0" cellspacing="0">
										<tr>
											<td height="3"></td>
										</tr>
										<tr>
											<td><button id="insertButton" onclick="insertFlash()" ><table width="100%" height="100%">
														<tr>
															<td id="buttonText">插 入</td>
														</tr>
													</table>
												</button>
											</td>
										</tr>
										<tr>
											<td height="4"></td>
										</tr>
										<tr>
											<td><button onclick="openFileDialog()" ID="Button1"><table width="100%" height="100%" ID="Table1">
														<tr>
															<td>浏 览</td>
														</tr>
													</table>
												</button>
											</td>
										</tr>
										<tr>
											<td height="4"></td>
										</tr>
										<tr>
											<td><button onclick="self.close()"><table width="100%" height="100%">
														<tr>
															<td>关 闭</td>
														</tr>
													</table>
												</button>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</form>
	</body>
</html>
